// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["clientExtensions"]

}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  id Int @id @default(autoincrement())
  name String
  description String?
  unit_price Float
  codeBar String?
  image String?
  type String?
  createedAt DateTime @default(now())
  updatedAt DateTime  @updatedAt
  quantityInStock  Int?
  boms Bom[]
  operations ProductionOperation[]
  manufacturingOrder ManufacturingOrder?
}


model Material{
  id Int @id @default(autoincrement())
  name String
  category String
  quantity Int
}


model Bom {
  id Int @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  name String
  description String
  quantity Int
  unit String
  products Product[]
}

model Machine {
  id Int @id @default(autoincrement())
  machine_name String
  state  State @default(ACTIVE)
  productionRate  Int  
  sheduled_start_date DateTime?
  sheduled_end_date DateTime?
  operations ProductionOperation @relation(fields: [operationId], references: [id])
  operationId Int @unique
}

model ProductionOperation {
  id Int @id @default(autoincrement())
  description String
  operationSquence Int
  product Product @relation(fields: [productId], references: [id],onDelete: Cascade )
  productId Int
  machine Machine?
  planned_start_date DateTime?
  planned_end_date DateTime?
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}


model ManufacturingOrder {
  id Int @id @default(autoincrement())
  product Product @relation(fields: [productId], references: [id])
  productId Int @unique
  quantity Int?  @default(20)
  scheduled_start_date DateTime?
  scheduled_end_date   DateTime?
  state               State?
  created_at          DateTime  @default(now())
  updated_at          DateTime  @updatedAt
}

enum State {
  ACTIVE
  INACTIVE
}
